This is the code used for the selection analyis from the paper "Eight thousand years of natural selection in Europe" (Mathieson et al. 2015). 

The commands in analysis/ANALYSIS should replicate the analysis and allow you to generate the figures shown in the paper. This includes calls to submit batch jobs using bsub, which you should replace with the appropriate calls for your own system, or just run jobs locally, which may be slow. 

Unfortunately the paths are hard coded, so things will be a lot easier if you name this directory ~/selection/code and put the data in the directory ~/data/v8/  with two subdirectories; use/ for the eigenstrat data merged with 1000 genomes and reads/ for the read count dayta. This data is available from the reich lab website. The analysis will create various subdirectories in the ~/selection/ directory.

As well as R and python (2) which most of the code is written in, you will need the packages spindrift (https://github.com/mathii/spindrift) and pyEigenstrat (https://github.com/mathii/pyEigenstrat).

- Iain Mathieson 15Oct15